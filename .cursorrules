# QAPlus é–‹ç™¼è¦ç¯„

## å°ˆæ¡ˆæ¦‚è¿°
- **å°ˆæ¡ˆåç¨±**: QAPlus - AI é©…å‹•çš„çŸ¥è­˜åº«ç®¡ç†ç³»çµ±
- **æ¶æ§‹**: Monorepo (Turborepo)
- **Backend**: NestJS + Prisma + PostgreSQL
- **Frontend**: Next.js 14 (App Router) + React 18 + TypeScript
- **èªè­‰**: Supabase Auth
- **å¤šèªè¨€**: next-intl 3.x (é‡è¦ï¼šä¸è¦å‡ç´šåˆ° 4.x)

## æ ¸å¿ƒé–‹ç™¼è¦å‰‡

### 1. å¤šèªè¨€ (i18n) - ğŸŒ **å¿…é ˆéµå®ˆ**
```typescript
// âœ… æ­£ç¢ºï¼šæ‰€æœ‰é¡¯ç¤ºæ–‡å­—éƒ½ç”¨ t()
const t = useTranslations('namespace')
<h1>{t('title')}</h1>
<button>{t('submit')}</button>

// âŒ éŒ¯èª¤ï¼šç¡¬ç·¨ç¢¼æ–‡å­—
<h1>ç™»å…¥</h1>
<button>é€å‡º</button>
```

**è¦å‰‡ï¼š**
- **ä»»ä½•é¡¯ç¤ºçµ¦ç”¨æˆ¶çš„æ–‡å­—éƒ½å¿…é ˆä½¿ç”¨ `t()`**
- ç¿»è­¯æª”ä½ç½®ï¼š`apps/frontend/messages/zh-TW.json`
- Console.log å’Œ debug è¨Šæ¯å¯ä»¥ç”¨ä¸­æ–‡
- éŒ¯èª¤è¨Šæ¯ä¹Ÿè¦ç¿»è­¯

### 2. èªè­‰ç³»çµ±
```typescript
// âœ… ä½¿ç”¨ Supabase Auth
const { user, signIn, signOut } = useAuth()

// âŒ ä¸è¦ä½¿ç”¨æœ¬åœ°å¯†ç¢¼èªè­‰
// Users è¡¨ä¸­æ²’æœ‰ password æ¬„ä½
```

**è¦å‰‡ï¼š**
- æ‰€æœ‰èªè­‰é€šé Supabase
- ç™»å…¥å¾Œè‡ªå‹•å‰µå»º tenant (tenant_id = user_id)
- ä½¿ç”¨ `supabaseUserId` é—œè¯ç”¨æˆ¶

### 3. TypeScript
```typescript
// âœ… å®Œæ•´å‹åˆ¥å®šç¾©
interface User {
  id: number
  email: string
  supabaseUserId: string | null
}

// âŒ é¿å…ä½¿ç”¨ any
const data: any = await fetchData() // ä¸å¥½
```

**è¦å‰‡ï¼š**
- æ‰€æœ‰å‡½æ•¸åƒæ•¸å’Œè¿”å›å€¼éƒ½è¦æœ‰å‹åˆ¥
- é¿å…ä½¿ç”¨ `any`ï¼Œå¿…è¦æ™‚ç”¨ `unknown`
- ä½¿ç”¨ Prisma ç”Ÿæˆçš„å‹åˆ¥

### 4. API è¨­è¨ˆ
```typescript
// âœ… çµ±ä¸€å›æ‡‰æ ¼å¼
{
  success: true,
  data: {...},
  message?: string
}

// âœ… éŒ¯èª¤è™•ç†
{
  success: false,
  error: string,
  message: string
}
```

**è¦å‰‡ï¼š**
- ä½¿ç”¨ RESTful API
- çµ±ä¸€éŒ¯èª¤è™•ç†æ ¼å¼
- Backend API è·¯å¾‘ï¼š`/api/`

### 5. è³‡æ–™åº«
```typescript
// âœ… ä½¿ç”¨ Prisma
await prisma.user.findUnique({ where: { id } })

// âœ… é¸æ“‡éœ€è¦çš„æ¬„ä½
select: {
  id: true,
  username: true,
  email: true,
}

// âŒ ä¸è¦é¸æ“‡æ‰€æœ‰æ¬„ä½ï¼ˆæ•ˆèƒ½è€ƒé‡ï¼‰
```

**è¦å‰‡ï¼š**
- æ‰€æœ‰è³‡æ–™åº«æ“ä½œä½¿ç”¨ Prisma
- ä½¿ç”¨ `select` é¿å…éåº¦æŸ¥è©¢
- ä½¿ç”¨äº‹å‹™è™•ç†è¤‡é›œæ“ä½œ
- Migration æª”æ¡ˆéœ€è¦æ‰‹å‹•æª¢æŸ¥

### 6. å…ƒä»¶é–‹ç™¼
```typescript
// âœ… ä½¿ç”¨ Client Component æ¨™è¨˜
'use client'

// âœ… åŒ¯å…¥ç¿»è­¯
import { useTranslations } from 'next-intl'

export default function MyComponent() {
  const t = useTranslations('myNamespace')
  
  return <div>{t('content')}</div>
}
```

**è¦å‰‡ï¼š**
- éœ€è¦äº’å‹•çš„çµ„ä»¶ä½¿ç”¨ `'use client'`
- æ‰€æœ‰æ–‡å­—ä½¿ç”¨ `t()`
- ä½¿ç”¨ Tailwind CSS æ¨£å¼
- çµ„ä»¶æª”æ¡ˆä½¿ç”¨ PascalCase

### 7. è·¯ç”±çµæ§‹
```
/[locale]/dashboard     â† å„€è¡¨æ¿
/[locale]/login         â† ç™»å…¥
/[locale]/chatbots/:id  â† Chatbot è©³æƒ…
```

**è¦å‰‡ï¼š**
- æ‰€æœ‰è·¯ç”±éƒ½åœ¨ `[locale]` ä¸‹
- ä½¿ç”¨ Next.js App Router
- å—ä¿è­·è·¯ç”±åœ¨ middleware è™•ç†

### 8. éŒ¯èª¤è™•ç†
```typescript
// âœ… å®Œæ•´éŒ¯èª¤è™•ç†
try {
  const result = await apiCall()
  return { success: true, data: result }
} catch (error) {
  console.error('[Component] Error:', error)
  return { success: false, error: error.message }
}
```

**è¦å‰‡ï¼š**
- æ‰€æœ‰ async å‡½æ•¸éƒ½è¦ try-catch
- éŒ¯èª¤è¨Šæ¯è¦ç¿»è­¯
- Console ä½¿ç”¨ `[Component Name]` å‰ç¶´

### 9. ç¨‹å¼ç¢¼é¢¨æ ¼
- ä½¿ç”¨ 2 ç©ºæ ¼ç¸®æ’
- å–®å¼•è™Ÿå­—ä¸²ï¼ˆé™¤äº† JSONï¼‰
- åˆ†è™Ÿçµå°¾
- ä½¿ç”¨ `const` é™¤ééœ€è¦é‡æ–°è³¦å€¼

### 10. è¨»è§£
```typescript
/**
 * ç²å–æˆ–å‰µå»ºç”¨æˆ¶
 * 
 * @param dto - åŒ…å« supabaseUserId, email, name
 * @returns ç”¨æˆ¶è³‡è¨Šå’Œæ˜¯å¦ç‚ºæ–°å»º
 */
async getOrCreateUser(dto: GetOrCreateUserDto) {
  // å¯¦ä½œ...
}
```

**è¦å‰‡ï¼š**
- è¤‡é›œé‚è¼¯è¦åŠ è¨»è§£
- å…¬é–‹ API ä½¿ç”¨ JSDoc
- è¨»è§£å¯ä»¥ç”¨ä¸­æ–‡

## åƒè€ƒå°ˆæ¡ˆ
- **AnswerGO**: `/Users/fweng/answergo`
- åŠŸèƒ½åƒè€ƒ AnswerGOï¼Œä½†ä½¿ç”¨æ›´å¥½çš„ç¨‹å¼ç¢¼å“è³ª
- ä½¿ç”¨ Prisma ä»£æ›¿ç›´æ¥ SQL
- ä½¿ç”¨ TypeScript å‹åˆ¥

## ç¦æ­¢äº‹é …
âŒ ç¡¬ç·¨ç¢¼æ–‡å­—ï¼ˆå¿…é ˆç”¨ t()ï¼‰
âŒ ä½¿ç”¨ `any` å‹åˆ¥
âŒ ç›´æ¥æ“ä½œå¯†ç¢¼ï¼ˆä½¿ç”¨ Supabase Authï¼‰
âŒ å¿½ç•¥éŒ¯èª¤è™•ç†
âŒ ä¸å¯«å‹åˆ¥å®šç¾©
âŒ éåº¦æŸ¥è©¢è³‡æ–™åº«ï¼ˆä½¿ç”¨ selectï¼‰

## é–‹ç™¼æµç¨‹
1. ç†è§£éœ€æ±‚
2. æª¢æŸ¥æ˜¯å¦éœ€è¦æ–°ç¿»è­¯ï¼ˆæ›´æ–° zh-TW.jsonï¼‰
3. å¯¦ä½œåŠŸèƒ½ï¼ˆè¨˜å¾—ç”¨ t()ï¼‰
4. è™•ç†éŒ¯èª¤
5. æ¸¬è©¦
6. æ›´æ–°æ–‡ä»¶

## å¤šèªè¨€ç¿»è­¯æª”çµæ§‹
```json
{
  "common": { "é€šç”¨æ–‡å­—" },
  "auth": { "èªè­‰ç›¸é—œ" },
  "dashboard": { "å„€è¡¨æ¿" },
  "chatbots": { "èŠå¤©æ©Ÿå™¨äºº" },
  "errors": { "éŒ¯èª¤è¨Šæ¯" }
}
```

---

**è¨˜ä½ï¼šæ‰€æœ‰é¡¯ç¤ºçµ¦ç”¨æˆ¶çš„æ–‡å­—éƒ½å¿…é ˆä½¿ç”¨ t()ï¼Œé€™æ˜¯æœ€é‡è¦çš„è¦å‰‡ï¼**

